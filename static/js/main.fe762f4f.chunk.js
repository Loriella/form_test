(this.webpackJsonpform_test=this.webpackJsonpform_test||[]).push([[0],{20:function(e,a){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAYAAAACsSQRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEOSURBVHgBpZPfTQMxDMY/J3f33BXYgG4QJuAQHK+UCTpCxQSoExQeESDBBG0ngBE6AjxC/hjngkDlaJu2liIlsfXL59gm5FrzOQDoQnZG1isU3+CuGkeXygKc25EAhmBc4b4kaHcCjz4aN4luygIwatjiCE/0tqzOTiO42BkQjf2z6DAqC1C5obz6ktLqmtoIKP01Ah/Is5dyZ3D6Uf/EkZaPVrNiI4AD4aEatL7GLZbiPOZ4LGeUDfibXlT37aN9Ab9/0qlCmOcCkpIza0A0gdX9ThkzAEkJcw12410BCUJhIYJ6KwHam3WAlE7NPZRuCuVv4bUMFo7bfljVpf8qiYHtQKlDOY8Q8L4NINoXx7C7UX9wJSoAAAAASUVORK5CYII="},21:function(e,a){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHiSURBVHgBxZfPSsNAEMYnVeKpIFqUCqKn9mJPPXnSF/BRvXny5qVezAsEFEEwp4rQXloQnI/M1O2aP5tkVz/4aLLd3fy6M7PZRhRGMXvCHrL70rZmz9lP7KU9ICL/umBP2XtG28q6T9kzgQsCMhVDCfudnck9VmYo3+N6wb5VmB3yJ4XAA+7Yz7QdAg0NVmOffcw+kntvIDbEZ0XfL/Yb+1RgsGpLHyA2xMJhDGAAO6Y8TGmPuqkNhAq5gyQe4KYLSBcIFXIIpd7fpXYqg0DpDuQasU9r5tmUbxuQIgj8qhv2odFvRHm5PlTMdSAwi6YgdRAoz5n0vaY8GbH8ScFcgMQmh5VrlCMuEGjPxPcy7qxgrlhAobQJiCvEyhgzr5jvkqRsqQFIGwgdB31Y7VeUhwzzbEJWB9IFYirtSQnEVsn3AkOYDyuFgKLAEHMXiDKQP4eAeg4QpoJAQFEDiFj6e4eAdGcdUf0LbF3Q5gUC0tCM5TNxGeQbQkGw5EMZUPe2DAKhIHq6/peVMEE0+foO/YNAKAiSMKOf435TCIR20AUCMg/P5+wT9iv9rpAyCAgHYfx1eGkLAZn7CF7NE7lG0uLAEhuARRDeZG/x+sttAeoxFEQRCIRcwVkScV/JwzMKrG+MmuN/zwKwTQAAAABJRU5ErkJggg=="},22:function(e,a){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAQCAYAAADNo/U5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADpSURBVHgBnVI5EoMwDJQ9pKIIvAD4GQ00FOEHgR+k5nXOCyAdx4AjORyGEHsmmgFbx2rXshkcTKbpHaTMgTFvDhWsqkq9hsO3FeC6ERYy6Hsf/fxYwLCzhH9MJkktsyww1sSxhwT1Jo+xBmx2uYT4b3SQgK6LVMdZ7nHF4Xj4iQ1EHSho1Lfl+Rx4AedmEOU5FzqoQYmhEUR5KZ/6mezydNKZSSD11VIbLoNwlDtNNEofzPICGMdmLw/AxrTe5wfkOGIZhHpzJytKC/egtiXHo6dyRqDiNKhhEKrRmkiSB3a6wW8rkbWgzRsVy2H613kFRwAAAABJRU5ErkJggg=="},25:function(e,a,t){e.exports=t(41)},30:function(e,a,t){},41:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(6),s=t.n(l),o=(t(30),t(2)),c=(t(39),t(7)),m=t(8),i=t(11),u=t(9),d=t(12),A=t(13),E=t.n(A),f=t(19),p=new(t.n(f).a)({apiKey:"18HvtaCOtIOr_VAI1J-Fl-8APx71OpA3nlz96yj_PCcKM1db-mbuA5dzXAqHmopLD2BxRsuI"});function h(e){return p.request({action:"track.get",id:e})}var v=function(){return function(e){e({type:"SET_SENT"}),setTimeout((function(){e({type:"UNSET_SENT"})}),5e3)}},g=function(e){switch(function(e){var a=Number(e);return-1===a?"sent":a>-1?"in_queue":"error"}(e)){case"sent":return r.a.createElement("span",{className:"text-success"},"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e");case"in_queue":return r.a.createElement("span",{className:"text-muted"},"\u0412 \u043e\u0447\u0435\u0440\u0435\u0434\u0438");default:return r.a.createElement("span",{className:"text-danger"},"\u041e\u0448\u0438\u0431\u043a\u0430")}},b=function(e){function a(){var e,t;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=Object(i.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).idTimeout=null,t.checkStatus=function(){h(t.props.mail.track_id).then((function(e){var a=e.obj,n=a.id,r=a.status;t.props.updateStatus(n,r),Number(r)>-1&&(t.idTimeout=setTimeout((function(){t.checkStatus()}),3e3))}))},t}return Object(d.a)(a,e),Object(m.a)(a,[{key:"componentDidMount",value:function(){this.checkStatus()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.idTimeout)}},{key:"render",value:function(){var e=this.props.mail;return r.a.createElement("tr",null,r.a.createElement("td",{className:"cell-w"},E()(e.date).locale("ru").format("DD MMMM")),r.a.createElement("td",{colSpan:"2",className:"text-over"},e.subject),r.a.createElement("td",{className:"text-right"},g(e.status)))}}]),a}(r.a.Component),_={updateStatus:function(e,a){return function(t){t({type:"UPDATE_STATUS",id:e,status:a})}}},N=Object(o.b)(null,_)(b),w=Object(o.b)((function(e){return{mails:e.mail.mails}}))((function(e){var a=e.mails;return r.a.createElement("div",{className:"pt-4"},r.a.createElement("h3",{className:"pl-1"},"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"),a.length>0?r.a.createElement("table",{className:"table table-sm table-borderless"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"cell-w",scope:"col"},"\u0414\u0430\u0442\u0430"),r.a.createElement("th",{scope:"col",colSpan:"2",className:"text-over"},"\u0422\u0435\u043c\u0430"),r.a.createElement("th",{className:"cell-w text-right",scope:"col"},"\u0421\u0442\u0430\u0442\u0443\u0441"))),r.a.createElement("tbody",null,a.map((function(e){return r.a.createElement(N,{key:e.track_id,mail:e})})))):r.a.createElement("div",{className:"pl-1"},"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0435\u0449\u0435 \u043d\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u043b\u0438\u0441\u044c"))})),S=Object(o.b)((function(e){var a=e.mail.mails[0];return{to_email:a&&a.to_email}}))((function(e){var a=e.to_email;return r.a.createElement("div",{className:"sent-m mt-4"},r.a.createElement("div",{className:"sent-m-wrap"},r.a.createElement("h3",null,"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u043d\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0443"),r.a.createElement("p",null,"\u0421\u043e\u0432\u0441\u0435\u043c \u0441\u043a\u043e\u0440\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432\u044b\u043b\u0435\u0442\u0438\u0442 \u0438\u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u0438 \u0431\u0443\u0434\u0435\u0442 \u0434\u0432\u0438\u0433\u0430\u0442\u044c\u0441\u044f \u0432 \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u043f\u043e\u0447\u0442\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f \xab",a,"\xbb \u0441\u043e \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c\u044e \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043e\u0432")))})),C=t(5),j=t(1),D=t(10),O=t(4),k=t.n(O),x=function(e){var a=e.id,t=e.labelText,n=e.type,l=e.placeholder,s=e.name,o=e.value,c=e.onChange,m=e.error;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:a},t),r.a.createElement("input",{id:a,type:n||"text",placeholder:l,name:s,value:o,onChange:c,className:k()("form-control",{"is-invalid":m})}),m?r.a.createElement("div",{className:"invalid-feedback"},m):null)},T=t(20),y=t.n(T),R=function(e){var a=e.onChange,t=e.updateFileError,n=e.name,l=e.error;return r.a.createElement("div",{className:"form-group"},r.a.createElement("img",{src:y.a,alt:"clip"}),r.a.createElement("label",{htmlFor:"attaches",className:"label-file"},"\u041f\u0440\u0438\u043a\u0440\u0435\u043f\u0438\u0442\u044c \u0444\u0430\u0439\u043b"),r.a.createElement("input",{className:k()("input-file",{"is-invalid":l}),id:n,name:n,type:"file",onChange:function(e){var r=e.target.files[0];if(r.size>L)t("\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0444\u0430\u0439\u043b");else{var l=new FileReader;l.onload=function(e){a({target:{name:n,value:e.target.result,size:r.size,file_name:r.name}})},l.readAsDataURL(r)}},accept:".jpg,.png,.gif,.doc,.xls,.pdf,.zip"}),l&&r.a.createElement("div",{className:"invalid-feedback"},l))},U=t(21),Q=t.n(U),M=t(22),z=t.n(M),I=function(e){var a=e.file_name,t=e.onDelete,n=e.index;return r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"rounded attachment d-flex justify-content-between align-items-center"},r.a.createElement("img",{src:Q.a,alt:"clip-large"}),r.a.createElement("span",null,a),r.a.createElement("button",{className:"attachment-delete",onClick:function(e){e.preventDefault(),t(n)}},r.a.createElement("img",{src:z.a,alt:"trash",className:"pr-2"}),"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))},B=function(e){var a=e.id,t=e.labelText,n=e.name,l=e.rows,s=e.value,o=e.onChange,c=e.error;return r.a.createElement("div",{className:"form-group col mb-1"},r.a.createElement("label",{htmlFor:a},t),r.a.createElement("textarea",{className:k()("form-control",{"is-invalid":c}),id:a,name:n,rows:l,value:s,onChange:o}),c?r.a.createElement("div",{className:"invalid-feedback"},c):null)};function F(e){e.preventDefault()}var G=function(e){var a=e.onDragLeave,t=e.onDrop;return r.a.createElement("div",{className:"drop-modal-wrap drop d-flex align-items-center",onDragLeave:a,onDrop:t,onDragOver:F},r.a.createElement("div",{className:"drop-modal"},r.a.createElement("h3",null,"\u0411\u0440\u043e\u0441\u0430\u0439\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u044e\u0434\u0430, \u044f \u043b\u043e\u0432\u043b\u044e"),r.a.createElement("p",null,"\u041c\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u043c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438 (jpg, png, gif), \u043e\u0444\u0438\u0441\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b (doc, xls, pdf) \u0438 zip-\u0430\u0440\u0445\u0438\u0432\u044b. \u0420\u0430\u0437\u043c\u0435\u0440\u044b \u0444\u0430\u0439\u043b\u0430 \u0434\u043e 5 \u041c\u0411")))},L=5242880,Y={values:{from_name:"",from_email:"",to_name:"",to_email:"",email_subject:"",message:"",attaches:[]},errors:{},show_drop_modal:!1},V=function(e){function a(e){var t;return Object(c.a)(this,a),(t=Object(i.a)(this,Object(u.a)(a).call(this,e))).validation=function(){var e={},a=/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i,n=t.state.values,r=n.from_name,l=n.from_email,s=n.to_name,o=n.to_email,c=n.email_subject,m=n.message,i=n.attaches;return 0===r.length&&(e.from_name="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u0435\u043b\u044f"),a.test(l)||(e.from_email="\u0412\u0432\u0435\u0434\u0435\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 email"),0===s.length&&(e.to_name="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f"),a.test(o)||(e.to_email="\u0412\u0432\u0435\u0434\u0435\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 email"),0===c.length&&(e.email_subject="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043c\u0443 \u043f\u0438\u0441\u044c\u043c\u0430"),0===m.length&&(e.message="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"),i.reduce((function(e,a){return a.size+e}),0)>20971520&&(e.attaches="\u0421\u0443\u043c\u043c\u0430\u0440\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u043e\u0432 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 20 \u041c\u0411"),e},t.normalizeValue=function(e,a){var t=e.name,n=e.value,r=e.file_name,l=e.size;switch(t){case"attaches":return[].concat(Object(D.a)(a.attaches),[{file_name:r,size:l,value:n}]);default:return n}},t.onChange=function(e){var a=e.target,n=a.name,r=a.value,l=a.file_name,s=a.size;t.setState((function(e){return{values:Object(j.a)({},e.values,Object(C.a)({},n,t.normalizeValue({name:n,value:r,file_name:l,size:s},e.values))),errors:Object(j.a)({},e.errors,Object(C.a)({},n,!1))}}))},t.onDelete=function(e){var a=t.state.values.attaches.filter((function(a,t){return t!==e}));t.setState({values:Object(j.a)({},t.state.values,{attaches:a})})},t.prepareLetterForServer=function(e){return{subject:e.email_subject,"from.name":e.from_name,"from.email":e.from_email,"to.name":e.to_name,message:{text:e.message},attaches:e.attaches.map((function(e){return{name:e.file_name,content:e.value,encoding:"base64"}}))}},t.onSubmit=function(e){e.preventDefault();var a=t.validation();if(Object.values(a).length>0)t.setState({errors:a});else{var n=t.prepareLetterForServer(t.state.values);t.props.sendingMessage(t.state.values.to_email,n)}},t.showDropZone=function(){t.setState({show_drop_modal:!0})},t.hideDropZone=function(){t.setState({show_drop_modal:!1})},t.onDrop=function(e){e.preventDefault(),t.setState({show_drop_modal:!1});var a=e.dataTransfer.files[0];if(a.size>L)return t.updateFileError("\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0444\u0430\u0439\u043b"),"invalid";var n=new FileReader;n.onload=function(e){t.onChange({target:{name:"attaches",value:e.target.result,size:a.size,file_name:a.name}})},n.readAsDataURL(a)},t.updateFileError=function(e){t.setState((function(a){return{errors:Object(j.a)({},a.errors,{attaches:e})}}))},t.state=Object(j.a)({},Y),t}return Object(d.a)(a,e),Object(m.a)(a,[{key:"render",value:function(){var e=this,a=this.state,t=a.values,n=a.errors;return r.a.createElement("div",{className:"position-relative"},r.a.createElement("form",{className:"form p-4 mt-4",noValidate:!0,onDragOver:this.showDropZone},r.a.createElement("h3",null,"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u043b\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439"),r.a.createElement("div",null,r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"col-md-6 pr-0 pt-2"},r.a.createElement(x,{id:"from_name",labelText:"\u041e\u0442 \u043a\u043e\u0433\u043e",placeholder:"\u0418\u043c\u044f",name:"from_name",value:t.from_name,onChange:this.onChange,error:n.from_name})),r.a.createElement("div",{className:"col-md-6 pl-0 pt-2"},r.a.createElement(x,{id:"from_email",labelText:"Email",placeholder:"Email",name:"from_email",type:"email",value:t.from_email,onChange:this.onChange,error:n.from_email})))),r.a.createElement("div",null,r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group col-md-6 pr-0 pt-3"},r.a.createElement(x,{id:"to_name",labelText:"\u041a\u043e\u043c\u0443",placeholder:"\u0418\u043c\u044f",name:"to_name",value:t.to_name,onChange:this.onChange,error:n.to_name})),r.a.createElement("div",{className:"form-group col-md-6 pl-0 pt-3"},r.a.createElement(x,{id:"to_email",labelText:"Email",placeholder:"Email",name:"to_email",type:"email",value:t.to_email,onChange:this.onChange,error:n.to_email})))),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group col"},r.a.createElement(x,{id:"email_subject",labelText:"\u0422\u0435\u043c\u0430 \u043f\u0438\u0441\u044c\u043c\u0430",placeholder:"\u0422\u0435\u043c\u0430 \u043f\u0438\u0441\u044c\u043c\u0430",name:"email_subject",value:t.email_subject,onChange:this.onChange,error:n.email_subject}))),r.a.createElement("div",{className:"form-row"},r.a.createElement(B,{id:"message",labelText:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",name:"message",rows:"6",value:t.message,onChange:this.onChange,error:n.message})),r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},t.attaches.map((function(a,t){return r.a.createElement(I,{key:t,file_name:a.file_name,index:t,onDelete:e.onDelete})})))),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"form-group col-md-6"},r.a.createElement(R,{onChange:this.onChange,updateFileError:this.updateFileError,name:"attaches",error:n.attaches}))),r.a.createElement("button",{type:"submit",className:"btn btn-primary w-25",onClick:this.onSubmit,disabled:this.props.sending},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")),this.state.show_drop_modal&&r.a.createElement(G,{onDragLeave:this.hideDropZone,onDrop:this.onDrop}))}}]),a}(r.a.Component),X={sendingMessage:function(e,a){return function(t){return t({type:"SEND_MESSAGE_REQUEST"}),function(e,a){return p.request({action:"issue.send.test",letter:a,sendwhen:"test",mca:[e]})}(e,a).then((function(n){t({type:"SEND_MESSAGE_SUCCESS",payload:{track_id:n["track.id"],status:"0",to_email:e,subject:a.subject,date:new Date}}),t(v())})).catch((function(e){t({type:"SEND_MESSAGE_ERROR",payload:{track_id:-(new Date).getTime(),status:"-2",subject:a.subject,date:new Date}})}))}}},K=Object(o.b)((function(e){return{sending:e.sending}}),X)(V),H=Object(o.b)((function(e){return{send_mail:e.mail.send_mail}}))((function(e){var a=e.send_mail;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"wrapper"},a?r.a.createElement(S,null):r.a.createElement(K,null),r.a.createElement(w,null)))}));t(40),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var q=t(3),J={mails:[],sending:!1,send_mail:!1},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SEND_MESSAGE_REQUEST":return Object(j.a)({},e,{sending:!0});case"SEND_MESSAGE_SUCCESS":case"SEND_MESSAGE_ERROR":return Object(j.a)({},e,{mails:[a.payload].concat(Object(D.a)(e.mails)),sending:!1});case"SET_SENT":return Object(j.a)({},e,{send_mail:!0});case"UNSET_SENT":return Object(j.a)({},e,{send_mail:!1});case"UPDATE_STATUS":var t=a.id,n=a.status,r=e.mails.map((function(e){return t===e.track_id?Object(j.a)({},e,{status:n}):e}));return Object(j.a)({},e,{mails:r});default:return e}},Z=Object(q.combineReducers)({mail:P}),W=t(23),$=t(24),ee=Object(q.createStore)(Z,Object($.composeWithDevTools)(Object(q.applyMiddleware)(W.a)));s.a.render(r.a.createElement(o.a,{store:ee},r.a.createElement(H,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[25,1,2]]]);
//# sourceMappingURL=main.fe762f4f.chunk.js.map